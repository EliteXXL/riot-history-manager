<router>
    <slot router={ this }/>

    <script>
        import { Router } from "history-manager";
        import { ROUTER, UNROUTE_METHOD, LAST_ROUTED } from "./constants";
        import { claim, release } from "./loading-bar";

        export default {
            onBeforeMount() {
                this[UNROUTE_METHOD] = () => {};
                this[ROUTER] = Router.create();
            },
            onMounted() {
                this[ROUTER].route("(.*)", () => {
                    claim(this); release(this);
                    this[LAST_ROUTED] = null;
                    this[UNROUTE_METHOD]();
                    this[UNROUTE_METHOD] = () => {};
                });
            },
            [LAST_ROUTED]: null
        }
    </script>
</router>